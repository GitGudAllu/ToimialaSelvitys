{"ast":null,"code":"import _slicedToArray from \"/Users/tuomo/PROJEKTITYO\\u0308/ryhmatyo/tklaskuri/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/tuomo/PROJEKTITYO\\u0308/ryhmatyo/tklaskuri/src/toimialat.js\";\nimport React, { useState, Component } from 'react';\nimport datatoimialatKunnittain from \"./toimialatKunnittain2\";\nimport dataToimialojenVerot from \"./toimialojenVerot\";\nimport dataPaastot from \"./paastotToimialoittain\";\nimport FadeIn from 'react-fade-in';\nimport toPage from './index'; // asetetaan dataa jsoneista muuttujiin\n\nconst toimialalista = datatoimialatKunnittain.dataset.dimension.Toimiala2008.category.label;\nconst toimialaIndeksit = datatoimialatKunnittain.dataset.dimension.Toimiala2008.category.index;\nconst toimialojenMaarat = datatoimialatKunnittain.dataset.value;\nconst kuntienIndeksit = datatoimialatKunnittain.dataset.dimension.Kunta.category.index;\nconst kuntienNimet = datatoimialatKunnittain.dataset.dimension.Kunta.category.label;\nconst nimiJaIndeksi = dataToimialojenVerot.dataset.dimension.Toimiala.category.index; //const toimialojenNimet = dataToimialojenVerot.dataset.dimension.Toimiala.category.label\n\nconst toimialojenVerot = dataToimialojenVerot.dataset.value;\nconst toimialojenPaastot = dataPaastot.dataset.value;\nconst toimialojenPaastotIndeksit = dataPaastot.dataset.dimension[\"Toimialat (TOL2008) ja kotitaloudet\"].category.index; //console.log(datatoimialatKunnittain)\n//Pääkomponentti toimialoille\n\nconst Toimialat = () => {\n  // Counter pitää tiedossa valitun toimialan indeksin\n  const _useState = useState(0),\n        _useState2 = _slicedToArray(_useState, 2),\n        counter = _useState2[0],\n        setCounter = _useState2[1];\n\n  const setToValue = value => setCounter(value); //iso läjä listoja\n\n\n  var enitenKunnassa = []; // var kuntienNimetTop = [];\n  //var kunnanAvain = [];\n\n  var verotaulukko = [];\n  var alataulukko = [];\n  var maarataulukko = [];\n  var kuntienToimialaLkm = [];\n  var paastotaulukko = [];\n  var toimialojenAvaimet = []; //var toimialojenVerotuloKA = [];\n  //var toimialojenPaastotKA = [];\n  //var kuntienToimialaSL = [];\n\n  var toimialaSL = [];\n  var kunnanNimiAvain;\n  var kuntienKaikkiToimialat = [];\n  var toimialojenLkm = Object.keys(toimialalista).length;\n  /*Jokaisen kunnan kaikki toimialat ovat peräkkäin listassa ositettuna \n  (n kpl koko suomen toimialoja, n kpl seuraavan kunnan toimialoja...)\n  Saadaksesi kunnan x kaikki toimialat, aloita ensimmäisestä kyseisen toimialan indeksistä\n  ja hyppää toimialojen lukumäärän verran eteenpäin. \n  */\n\n  function toimialanPaikkakunnat(counter) {\n    var haettavaIndeksi = toimialojenAvaimet[counter];\n    var ekaToimialanArvo = toimialaIndeksit[haettavaIndeksi];\n\n    for (let i = ekaToimialanArvo; i < toimialojenMaarat.length; i = i + toimialojenLkm) {\n      kuntienToimialaLkm.push(toimialojenMaarat[i]);\n    }\n\n    etsiEniten();\n    kunnanNimiAvain = haeAvain(kuntienIndeksit, enitenKunnassa[1]);\n  } //laskee toimialoille suhdeluvut\n\n\n  function laskeToimialojenSL() {\n    var toimialanvero = verotaulukko[counter];\n    var toimialanpaasto = paastotaulukko[counter];\n\n    for (let i = 0; i < kuntienToimialaLkm.length; i++) {\n      if (typeof toimialanpaasto === 'undefined') {\n        toimialaSL[i] = \"Ei tiedossa\";\n        break;\n      }\n\n      toimialaSL[i] = {\n        kunnanindeksi: i,\n        suhde: toimialanvero / toimialanpaasto * (kuntienToimialaLkm[i] / kuntienKaikkiToimialat[i])\n      };\n    }\n\n    let suhdeluvutJarj = toimialaSL;\n    suhdeluvutJarj.sort(function (a, b) {\n      return b.suhde - a.suhde;\n    }); //console.log(\"verotaulukko \" , verotaulukko)\n    // console.log(\"paastotaulukko \", paastotaulukko)\n    // console.log(\"kuntienToimialaLkm \", kuntienToimialaLkm)\n    //console.log(\"kuntienKaikkiToimialat \" , kuntienKaikkiToimialat)\n    // console.log(\"toimialasl \" , toimialaSL)\n\n    for (let i = 0; i < suhdeluvutJarj.length; i++) {\n      if (suhdeluvutJarj[i].suhde == 0) suhdeluvutJarj.splice(i, suhdeluvutJarj.length - i);else continue;\n    }\n\n    return suhdeluvutJarj;\n  } //Annetaan value, jolle etsitään ja palautetaan sitä vastaava key\n\n\n  function haeAvain(lista, value) {\n    return Object.keys(lista).find(key => lista[key] === value);\n  } //Hakee jokaisen kunnan toimialojen määrän listaan. Kokomaa = 0, Akaa = 1...\n\n\n  function KunnanKaikkiToimialatLkm() {\n    for (let key in kuntienIndeksit) {\n      kuntienKaikkiToimialat[kuntienIndeksit[key]] = toimialojenMaarat[toimialojenLkm * kuntienIndeksit[key]];\n    }\n  } //pitää järjestettyä listaa eniten valittua toimialaa sisältävien kuntien indekseistä\n\n\n  function etsiEniten() {\n    //    var suurin = 0;\n    //   var maxIndex = 0;\n    for (let i = 0; i < kuntienToimialaLkm.length; i++) {\n      enitenKunnassa.push(i);\n      enitenKunnassa.sort(function (a, b) {\n        return kuntienToimialaLkm[b] - kuntienToimialaLkm[a];\n      });\n    }\n\n    KunnanKaikkiToimialatLkm();\n  } //Luo ison läjän keyn mukaan indeksöityjä listoja\n  //listasta valittaessa saadaan samalla indeksillä muista listoista oikeita arvoja\n\n\n  function luoTaulukot() {\n    for (let key in toimialalista) {\n      if (key.length === 2) {\n        toimialojenAvaimet.push(key);\n        alataulukko.push(toimialalista[key]);\n        maarataulukko.push(toimialojenMaarat[toimialaIndeksit[key]]);\n        paastotaulukko.push(toimialojenPaastot[toimialojenPaastotIndeksit[key]]);\n\n        if (toimialojenVerot[nimiJaIndeksi[key]] == null) {\n          verotaulukko.push(\"Ei tiedossa\");\n        } else {\n          verotaulukko.push(toimialojenVerot[nimiJaIndeksi[key]]);\n        }\n      }\n    }\n\n    return alataulukko;\n  } //Korvaa toimialojen nimissä olevat numerot ja alun välit tyhjällä\n\n\n  function parsiTaulukko(taulukko) {\n    for (let x in taulukko) {\n      taulukko[x] = taulukko[x].replace(/^[\\s\\d]+/, '');\n    }\n  }\n\n  var toimialaInd = 0;\n  var haettava;\n  var select;\n  var taulukkoToimialoista = luoTaulukot();\n  parsiTaulukko(taulukkoToimialoista); //Hakupalkki, joka vertaa hakupalkin sisältöä select -listan sisältöön ja näyttää vain matchaavat\n\n  const etsiToimiala = hakusana => {\n    haettava = hakusana.target.value;\n    select = document.getElementById(\"listaToimialoista\");\n\n    for (var i = 0; i < select.length; i++) {\n      var txt = select[i].text;\n      var include = txt.toLowerCase().startsWith(haettava.toLowerCase());\n      select.options[i].style.display = include ? '' : 'none';\n    }\n  }; //asettaa countteriin valitun indeksin, josta sitä voi sitten käyttää kaikkialla\n\n\n  const tulostaToimiala = listaValittu => {\n    setToValue(listaValittu.target.value);\n  }; //tämä pitää olla täällä, koska counter\n\n\n  toimialanPaikkakunnat(counter);\n  var suhdeluvutJarj = laskeToimialojenSL();\n\n  function ka(lista) {\n    var summa = 0;\n\n    for (let x in lista) {\n      summa = summa + lista[x].suhde;\n    }\n\n    var keskiarvo = summa / lista.length;\n    return keskiarvo;\n  }\n\n  var kaSuhdeluku = ka(suhdeluvutJarj);\n  console.log(\"kasuhdeluku \", kaSuhdeluku);\n  console.log(\"eka \", suhdeluvutJarj[0].suhde);\n  console.log(\"ekan suhde ka:han \", suhdeluvutJarj[0].suhde / kaSuhdeluku);\n  console.log(\"vika suhde ka:han \", suhdeluvutJarj[suhdeluvutJarj.length - 1].suhde / kaSuhdeluku);\n  console.log(\"vika? \", suhdeluvutJarj[suhdeluvutJarj.length - 1].suhde);\n  console.log(\"kokopaska \", suhdeluvutJarj);\n  var mediaaniIndeksi = Math.floor(suhdeluvutJarj.length / 2);\n  console.log(\"mediaaniindeksi \", mediaaniIndeksi); // jakaa hienosti regexillä luvut kolmen sarjoihin\n\n  function lukupilkuilla(x) {\n    if (x === undefined) return \"Ei tiedossa\";else return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \" \");\n  }\n\n  let paastoTulostus = \"Ei tiedossa\";\n\n  if (lukupilkuilla(paastotaulukko[counter]) !== \"Ei tiedossa\") {\n    paastoTulostus = lukupilkuilla(paastotaulukko[counter]) + \" tonnia/vuosi\";\n  }\n\n  let veroTulostus = \"Ei Tiedossa\";\n\n  if (lukupilkuilla(verotaulukko[counter]) !== \"Ei tiedossa\") {\n    veroTulostus = lukupilkuilla(verotaulukko[counter]) + \" €/vuosi\";\n  }\n\n  const Maara = () => {\n    let monesko = \"\";\n    let monesko2 = 1;\n    var lista = [];\n\n    for (let i = 1; i < enitenKunnassa.length; i++) {\n      let kunta = kuntienNimet[haeAvain(kuntienIndeksit, enitenKunnassa[i])];\n\n      if (kuntienToimialaLkm[enitenKunnassa[i]] === 0) {\n        break;\n      }\n\n      lista.push(React.createElement(\"li\", {\n        class: \"list-group-item\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248\n        },\n        __self: this\n      }, React.createElement(\"small\", {\n        class: \"text-muted\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248\n        },\n        __self: this\n      }, monesko, \" Eniten paikkakunnalla: \"), \" \", kunta, React.createElement(\"small\", {\n        class: \"text-muted\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249\n        },\n        __self: this\n      }, \" M\\xE4\\xE4r\\xE4: \"), kuntienToimialaLkm[enitenKunnassa[i]], \" \"));\n      monesko2++;\n      monesko = monesko2 + \".\";\n    }\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    }, lista);\n  };\n\n  const Suhdeluku = () => {\n    let monesko = \"\";\n    let monesko2 = 1;\n    var lista = [];\n\n    for (let i = 0; i < suhdeluvutJarj.length; i++) {\n      let kunta = kuntienNimet[haeAvain(kuntienIndeksit, suhdeluvutJarj[i].kunnanindeksi)];\n\n      if (typeof suhdeluvutJarj[0].suhde === 'undefined') {\n        lista.push(React.createElement(\"li\", {\n          class: \"list-group-item\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 273\n          },\n          __self: this\n        }, React.createElement(\"small\", {\n          class: \"text-muted\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 273\n          },\n          __self: this\n        }, \" Ei voida laskea \")));\n        break;\n      }\n\n      if (suhdeluvutJarj[i].suhde === 0) {\n        break;\n      }\n\n      lista.push(React.createElement(\"li\", {\n        class: \"list-group-item\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 279\n        },\n        __self: this\n      }, React.createElement(\"small\", {\n        class: \"text-muted\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 279\n        },\n        __self: this\n      }, monesko, \" Paras hy\\xF6tysuhde: \"), \" \", kunta, React.createElement(\"small\", {\n        class: \"text-muted\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280\n        },\n        __self: this\n      }, \" Suhdeluku: \"), (suhdeluvutJarj[i].suhde / suhdeluvutJarj[mediaaniIndeksi].suhde * 100).toFixed(2), \" % mediaanista\"));\n      monesko2++;\n      monesko = monesko2 + \".\";\n    }\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }, lista);\n  };\n\n  const _useState3 = useState('maara'),\n        _useState4 = _slicedToArray(_useState3, 2),\n        page = _useState4[0],\n        setPage = _useState4[1];\n\n  const toPage = page => event => {\n    event.preventDefault();\n    setPage(page);\n  };\n\n  const content = () => {\n    if (page === 'suhdeluku') {\n      return React.createElement(Suhdeluku, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 305\n        },\n        __self: this\n      });\n    } else if (page === 'maara') {\n      return React.createElement(Maara, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 307\n        },\n        __self: this\n      });\n    }\n  };\n\n  return (// Bootstrapin pääcontainer\n    React.createElement(FadeIn, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 314\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-sm\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      id: \"search\",\n      className: \"form-control\",\n      name: \"search\",\n      placeholder: \"Hae...\",\n      onKeyUp: etsiToimiala,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 322\n      },\n      __self: this\n    })), React.createElement(\"select\", {\n      id: \"listaToimialoista\",\n      className: \"form-control\",\n      size: \"30\",\n      onChange: tulostaToimiala,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 325\n      },\n      __self: this\n    }, taulukkoToimialoista.map(s => React.createElement(\"option\", {\n      value: toimialaInd++,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327\n      },\n      __self: this\n    }, s)))), React.createElement(\"div\", {\n      className: \"col-6\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 333\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 336\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col jumbotron\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 337\n      },\n      __self: this\n    }, React.createElement(\"ul\", {\n      class: \"list-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      class: \"list-group-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341\n      },\n      __self: this\n    }, React.createElement(\"small\", {\n      class: \"text-muted\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341\n      },\n      __self: this\n    }, \"Toimialan kokonaisp\\xE4\\xE4st\\xF6t: \"), paastoTulostus), React.createElement(\"li\", {\n      class: \"list-group-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342\n      },\n      __self: this\n    }, React.createElement(\"small\", {\n      class: \"text-muted\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342\n      },\n      __self: this\n    }, \"Toimialojen kokonaislukum\\xE4\\xE4r\\xE4: \"), \" \", lukupilkuilla(maarataulukko[counter]), \" kpl\"), React.createElement(\"li\", {\n      class: \"list-group-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343\n      },\n      __self: this\n    }, \" \", React.createElement(\"small\", {\n      class: \"text-muted\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343\n      },\n      __self: this\n    }, \"Toimialan verot yhteens\\xE4: \"), \" \", veroTulostus), React.createElement(\"li\", {\n      class: \"list-group-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344\n      },\n      __self: this\n    }, \" \", React.createElement(\"small\", {\n      class: \"text-muted\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344\n      },\n      __self: this\n    }, \"Toimialaa eniten paikkakunnalla: \"), \" \", kuntienNimet[kunnanNimiAvain], \" Lkm: \", kuntienToimialaLkm[kuntienIndeksit[kunnanNimiAvain]], \" kpl\")))), React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 350\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col jumbotron\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 352\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"btn-group btn-group-sm\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 354\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn btn-secondary\",\n      \"aria-pressed\": \"true\",\n      onClick: toPage('maara'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 355\n      },\n      __self: this\n    }, \"M\\xE4\\xE4r\\xE4\"), React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn btn-secondary\",\n      \"aria-pressed\": \"true\",\n      onClick: toPage('suhdeluku'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 356\n      },\n      __self: this\n    }, \"Suhdeluku\")), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 358\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      class: \"oikeala\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 359\n      },\n      __self: this\n    }, content())), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 363\n      },\n      __self: this\n    })))))))\n  );\n};\n\nexport default Toimialat;","map":{"version":3,"sources":["/Users/tuomo/PROJEKTITYÖ/ryhmatyo/tklaskuri/src/toimialat.js"],"names":["React","useState","Component","datatoimialatKunnittain","dataToimialojenVerot","dataPaastot","FadeIn","toPage","toimialalista","dataset","dimension","Toimiala2008","category","label","toimialaIndeksit","index","toimialojenMaarat","value","kuntienIndeksit","Kunta","kuntienNimet","nimiJaIndeksi","Toimiala","toimialojenVerot","toimialojenPaastot","toimialojenPaastotIndeksit","Toimialat","counter","setCounter","setToValue","enitenKunnassa","verotaulukko","alataulukko","maarataulukko","kuntienToimialaLkm","paastotaulukko","toimialojenAvaimet","toimialaSL","kunnanNimiAvain","kuntienKaikkiToimialat","toimialojenLkm","Object","keys","length","toimialanPaikkakunnat","haettavaIndeksi","ekaToimialanArvo","i","push","etsiEniten","haeAvain","laskeToimialojenSL","toimialanvero","toimialanpaasto","kunnanindeksi","suhde","suhdeluvutJarj","sort","a","b","splice","lista","find","key","KunnanKaikkiToimialatLkm","luoTaulukot","parsiTaulukko","taulukko","x","replace","toimialaInd","haettava","select","taulukkoToimialoista","etsiToimiala","hakusana","target","document","getElementById","txt","text","include","toLowerCase","startsWith","options","style","display","tulostaToimiala","listaValittu","ka","summa","keskiarvo","kaSuhdeluku","console","log","mediaaniIndeksi","Math","floor","lukupilkuilla","undefined","toString","paastoTulostus","veroTulostus","Maara","monesko","monesko2","kunta","Suhdeluku","toFixed","page","setPage","event","preventDefault","content","map","s"],"mappings":"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","sourcesContent":["import React, { useState, Component } from 'react';\nimport datatoimialatKunnittain from \"./toimialatKunnittain2\";\nimport dataToimialojenVerot from \"./toimialojenVerot\";\nimport dataPaastot from \"./paastotToimialoittain\";\nimport FadeIn from 'react-fade-in';\nimport toPage from './index';\n\n// asetetaan dataa jsoneista muuttujiin\n\nconst toimialalista = datatoimialatKunnittain.dataset.dimension.Toimiala2008.category.label\nconst toimialaIndeksit = datatoimialatKunnittain.dataset.dimension.Toimiala2008.category.index\nconst toimialojenMaarat = datatoimialatKunnittain.dataset.value\nconst kuntienIndeksit = datatoimialatKunnittain.dataset.dimension.Kunta.category.index\nconst kuntienNimet = datatoimialatKunnittain.dataset.dimension.Kunta.category.label\n\nconst nimiJaIndeksi = dataToimialojenVerot.dataset.dimension.Toimiala.category.index\n//const toimialojenNimet = dataToimialojenVerot.dataset.dimension.Toimiala.category.label\nconst toimialojenVerot = dataToimialojenVerot.dataset.value\n\nconst toimialojenPaastot = dataPaastot.dataset.value\nconst toimialojenPaastotIndeksit = dataPaastot.dataset.dimension[\"Toimialat (TOL2008) ja kotitaloudet\"].category.index;\n\n\n\n//console.log(datatoimialatKunnittain)\n\n//Pääkomponentti toimialoille\nconst Toimialat = () => {\n\n  // Counter pitää tiedossa valitun toimialan indeksin\n  const [ counter, setCounter ] = useState(0)\n  const setToValue = (value) => setCounter(value)\n  \n  //iso läjä listoja\n  var enitenKunnassa = [];\n // var kuntienNimetTop = [];\n  //var kunnanAvain = [];\n  var verotaulukko = [];\n  var alataulukko = [];\n  var maarataulukko = [];\n  var kuntienToimialaLkm = [];\n  var paastotaulukko = [];\n  var toimialojenAvaimet = [];\n  //var toimialojenVerotuloKA = [];\n  //var toimialojenPaastotKA = [];\n  //var kuntienToimialaSL = [];\n  var toimialaSL = [];\n  var kunnanNimiAvain;\n  var kuntienKaikkiToimialat = [];\n  var toimialojenLkm = Object.keys(toimialalista).length\n\n\n\n  /*Jokaisen kunnan kaikki toimialat ovat peräkkäin listassa ositettuna \n  (n kpl koko suomen toimialoja, n kpl seuraavan kunnan toimialoja...)\n  Saadaksesi kunnan x kaikki toimialat, aloita ensimmäisestä kyseisen toimialan indeksistä\n  ja hyppää toimialojen lukumäärän verran eteenpäin. \n  */\n  function toimialanPaikkakunnat(counter) {\n    var haettavaIndeksi = toimialojenAvaimet[counter]\n    var ekaToimialanArvo = toimialaIndeksit[haettavaIndeksi]\n    \n    for (let i = ekaToimialanArvo; i < toimialojenMaarat.length; i = (i+toimialojenLkm)){\n      \n      kuntienToimialaLkm.push(toimialojenMaarat[i])\n    }\n\n    etsiEniten();\n    kunnanNimiAvain = haeAvain(kuntienIndeksit, enitenKunnassa[1])\n    \n  }\n\n  //laskee toimialoille suhdeluvut\n  function laskeToimialojenSL(){\n    var toimialanvero = verotaulukko[counter]\n    var toimialanpaasto = paastotaulukko[counter]\n    for (let i = 0; i < kuntienToimialaLkm.length ;i++){\n      if(typeof toimialanpaasto === 'undefined'){\n        toimialaSL[i] = \"Ei tiedossa\";\n        break;\n      }\n      \n      toimialaSL[i] = {kunnanindeksi: i, suhde: ((toimialanvero/toimialanpaasto) * (kuntienToimialaLkm[i]/kuntienKaikkiToimialat[i]))}\n      \n    }\n\n    let suhdeluvutJarj = toimialaSL\n    suhdeluvutJarj.sort(function(a, b){\n      return b.suhde - a.suhde;\n    })\n    //console.log(\"verotaulukko \" , verotaulukko)\n   // console.log(\"paastotaulukko \", paastotaulukko)\n   // console.log(\"kuntienToimialaLkm \", kuntienToimialaLkm)\n    //console.log(\"kuntienKaikkiToimialat \" , kuntienKaikkiToimialat)\n   // console.log(\"toimialasl \" , toimialaSL)\n   for ( let i = 0; i < suhdeluvutJarj.length; i++){\n     if(suhdeluvutJarj[i].suhde == 0) suhdeluvutJarj.splice(i, (suhdeluvutJarj.length - i));\n     else continue;\n   }\n    return suhdeluvutJarj;\n  }\n\n  //Annetaan value, jolle etsitään ja palautetaan sitä vastaava key\n  function haeAvain(lista, value){\n\n  \treturn Object.keys(lista).find(key => lista[key] === value);\n\n  }\n\n  //Hakee jokaisen kunnan toimialojen määrän listaan. Kokomaa = 0, Akaa = 1...\n  function KunnanKaikkiToimialatLkm(){\n  \t \n  \tfor (let key in kuntienIndeksit){\n  \t\t\n      kuntienKaikkiToimialat[kuntienIndeksit[key]] = toimialojenMaarat[(toimialojenLkm * kuntienIndeksit[key])]\n    \t\n    }\n    \n    \n  }\n\n  //pitää järjestettyä listaa eniten valittua toimialaa sisältävien kuntien indekseistä\n  function etsiEniten(){\n    \n//    var suurin = 0;\n //   var maxIndex = 0;\n\n    for (let i = 0; i < kuntienToimialaLkm.length; i++){\n    \t\n      enitenKunnassa.push(i);\t\n    \tenitenKunnassa.sort(function(a,b) { return kuntienToimialaLkm[b] - kuntienToimialaLkm[a];});\n    \t\t\n    \t}\n\n    KunnanKaikkiToimialatLkm();   \n  }\n\n  \n  //Luo ison läjän keyn mukaan indeksöityjä listoja\n  //listasta valittaessa saadaan samalla indeksillä muista listoista oikeita arvoja\n  function luoTaulukot() {\n    \n    for (let key in toimialalista){\n      if(key.length === 2){\n\n        toimialojenAvaimet.push(key)\n        alataulukko.push(toimialalista[key])\n        maarataulukko.push(toimialojenMaarat[toimialaIndeksit[key]])\n        paastotaulukko.push(toimialojenPaastot[toimialojenPaastotIndeksit[key]])\n        if (toimialojenVerot[nimiJaIndeksi[key]] == null){\n          \n          verotaulukko.push(\"Ei tiedossa\")\n        } \n        else {\n          \n         verotaulukko.push(toimialojenVerot[nimiJaIndeksi[key]])\n        }\n      } \n    }           \n    \n    return alataulukko;\n  }\n    //Korvaa toimialojen nimissä olevat numerot ja alun välit tyhjällä\n    function parsiTaulukko(taulukko){\n\n      for(let x in taulukko){\n        taulukko[x] = taulukko[x].replace(/^[\\s\\d]+/, '');\n      }\n    }\n\n    var toimialaInd = 0;\n    var haettava;\n    var select;\n    var taulukkoToimialoista = luoTaulukot();\n    parsiTaulukko(taulukkoToimialoista);\n    \n    //Hakupalkki, joka vertaa hakupalkin sisältöä select -listan sisältöön ja näyttää vain matchaavat\n    const etsiToimiala = (hakusana) => {\n   \n      haettava = hakusana.target.value\n      select = document.getElementById(\"listaToimialoista\");\n      for (var i = 0; i < select.length; i++){\n        var txt = select[i].text\n        var include = txt.toLowerCase().startsWith(haettava.toLowerCase());\n        select.options[i].style.display = include ? '' : 'none';\n     \n      }\n    }\n\n\n \n  //asettaa countteriin valitun indeksin, josta sitä voi sitten käyttää kaikkialla\n   const tulostaToimiala = (listaValittu) => {\n    setToValue(listaValittu.target.value)\n \n }\n\n  //tämä pitää olla täällä, koska counter\n  toimialanPaikkakunnat(counter)\n  \n  var suhdeluvutJarj = laskeToimialojenSL();\n  \n  function ka(lista){\n    var summa = 0;\n    for (let x in lista){\n      summa = summa + lista[x].suhde\n    }\n    var keskiarvo = summa/(lista.length)\n    return keskiarvo;\n  }\n  var kaSuhdeluku = ka(suhdeluvutJarj)\n  console.log(\"kasuhdeluku \" ,kaSuhdeluku)\n  console.log(\"eka \" , suhdeluvutJarj[0].suhde)\n  console.log(\"ekan suhde ka:han \" , (suhdeluvutJarj[0].suhde/kaSuhdeluku))\n  console.log(\"vika suhde ka:han \" , (suhdeluvutJarj[suhdeluvutJarj.length-1].suhde/kaSuhdeluku))\n  console.log(\"vika? \" , suhdeluvutJarj[suhdeluvutJarj.length-1].suhde)\n  console.log(\"kokopaska \" , suhdeluvutJarj)\n  \n  var mediaaniIndeksi = Math.floor(suhdeluvutJarj.length/2)\n  console.log(\"mediaaniindeksi \" , mediaaniIndeksi)\n  // jakaa hienosti regexillä luvut kolmen sarjoihin\n  function lukupilkuilla(x) {\n    if (x === undefined) return \"Ei tiedossa\";\n    else return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \" \");\n  }\n \n  let paastoTulostus = \"Ei tiedossa\";\n  if( lukupilkuilla(paastotaulukko[counter]) !== \"Ei tiedossa\") {\n    paastoTulostus = lukupilkuilla(paastotaulukko[counter]) + \" tonnia/vuosi\";\n  }\n  let veroTulostus = \"Ei Tiedossa\";\n    if ( lukupilkuilla(verotaulukko[counter]) !== \"Ei tiedossa\"){\n      veroTulostus = lukupilkuilla(verotaulukko[counter]) + \" €/vuosi\";\n    }\n    \n\n  const Maara = () => {\n    let monesko = \"\";\n    let monesko2 = 1;\n    var lista = [];\n    \n    for(let i = 1; i < enitenKunnassa.length; i++){\n\n      let kunta = kuntienNimet[haeAvain(kuntienIndeksit, enitenKunnassa[i])]\n      if(kuntienToimialaLkm[enitenKunnassa[i]] === 0){\n        break;\n      }\n      lista.push(<li class=\"list-group-item\"><small class=\"text-muted\">{monesko} Eniten paikkakunnalla: </small> {kunta}\n      <small class=\"text-muted\"> Määrä: </small>{kuntienToimialaLkm[enitenKunnassa[i]]} </li>)\n\n      monesko2++\n      monesko = monesko2 + \".\"\n    }\n\n    return (\n      <div>\n        {lista}\n      </div>\n    )\n    \n  }\n\n  const Suhdeluku = () => {\n\n    let monesko = \"\";\n    let monesko2 = 1;\n    var lista = [];\n\n    for(let i = 0; i < suhdeluvutJarj.length; i++){\n\n    let kunta = kuntienNimet[haeAvain(kuntienIndeksit, suhdeluvutJarj[i].kunnanindeksi)]\n    if(typeof suhdeluvutJarj[0].suhde === 'undefined'){\n      lista.push(<li class=\"list-group-item\"><small class=\"text-muted\"> Ei voida laskea </small></li>)\n      break;\n    }\n    if(suhdeluvutJarj[i].suhde === 0){\n      break;\n    }\n    lista.push(<li class=\"list-group-item\"><small class=\"text-muted\">{monesko} Paras hyötysuhde: </small> {kunta}\n      <small class=\"text-muted\"> Suhdeluku: </small>{((suhdeluvutJarj[i].suhde/suhdeluvutJarj[mediaaniIndeksi].suhde)*100).toFixed(2)} % mediaanista</li>)\n\n    monesko2++\n    monesko = monesko2 + \".\"\n\n    }\n\n    return (\n      <div>\n        {lista}\n      </div>\n    )\n  }\n\n  const [page, setPage] = useState('maara')\n\n  const toPage = (page) => (event) => {\n    event.preventDefault()\n    setPage(page)\n  }\n\n\n\n  const content = () => {\n    if (page === 'suhdeluku') {\n      return <Suhdeluku />\n    } else if (page === 'maara') {\n      return <Maara />\n    }\n  }\n\n return (\n  // Bootstrapin pääcontainer\n  <FadeIn>\n  <div className=\"container\"> \n\n  \n  \n      <div className=\"row\">\n            <div className=\"col-sm\">\n              \n              <div>\n              <input type=\"text\" id=\"search\" className=\"form-control\" name=\"search\" placeholder=\"Hae...\" onKeyUp={etsiToimiala}/>\n              </div>\n          \n              <select id=\"listaToimialoista\"className=\"form-control\" size=\"30\" onChange={tulostaToimiala} >\n                \n              {taulukkoToimialoista.map(s => (<option value={toimialaInd++}>{s}</option>))}\n              </select>\n\n\n            </div>\n\n            <div className=\"col-6\">\n\n\n            <div className=\"row\">\n            <div className=\"col jumbotron\">\n\n            <ul class=\"list-group\">\n\n      <li class=\"list-group-item\"><small class=\"text-muted\">Toimialan kokonaispäästöt: </small>{paastoTulostus}</li>\n      <li class=\"list-group-item\"><small class=\"text-muted\">Toimialojen kokonaislukumäärä: </small> {lukupilkuilla(maarataulukko[counter])} kpl</li>\n      <li class=\"list-group-item\"> <small class=\"text-muted\">Toimialan verot yhteensä: </small> {veroTulostus}</li>\n      <li class=\"list-group-item\"> <small class=\"text-muted\">Toimialaa eniten paikkakunnalla: </small> {kuntienNimet[kunnanNimiAvain]} Lkm: {kuntienToimialaLkm[kuntienIndeksit[kunnanNimiAvain]]} kpl</li>    \n            </ul>\n\n            </div>\n            </div>\n\n            <div className=\"row\">\n\n            <div className=\"col jumbotron\">\n\n            <div className=\"btn-group btn-group-sm\">\n                <button type=\"button\" className=\"btn btn-secondary\" aria-pressed=\"true\" onClick={toPage('maara')}>Määrä</button>\n                <button type=\"button\" className=\"btn btn-secondary\" aria-pressed=\"true\" onClick={toPage('suhdeluku')}>Suhdeluku</button>\n              </div>\n              <div>\n              <div class=\"oikeala\">\n                {content()}\n                </div>\n              </div>\n            <p></p>\n\n            </div>\n            </div>\n\n            </div>\n    </div>\n\n    </div>\n    </FadeIn>\n\n        );\n  }\n\n\nexport default Toimialat;\n"]},"metadata":{},"sourceType":"module"}